#!/usr/bin/env python3

# Extract the results for a single test run from the combined input file.

import fileinput
import sys

if len(sys.argv) < 2:
   sys.exit("usage: extractResults BENCHMARK [INPUT_FILES...]")

benchmark = sys.argv.pop(1)

data = []
found = False

for line in fileinput.input():
    line = line.rstrip()

    if line == '' or line.startswith('#') or line == '----':
        continue

    if line.startswith("MinorGC:"):
        elements = line.split()
        if elements[3] == "Size":
            continue
        data.append(elements)
        continue

    if ": " in line:
        name = line.split(":")[0]
        if name == benchmark:
            for elements in data:
                print(elements[3])
            found = True
            break
        data = []
        continue

    sys.exit("Can't parse line: " + line)

if not found:
    sys.exit("Requested data set not found")
